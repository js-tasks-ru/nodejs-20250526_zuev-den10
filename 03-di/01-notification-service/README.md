# Задание: Реализация сервиса уведомлений

В этом задании вы реализуете сервис уведомлений (`NotificationService`) для отправки сообщений пользователям. Вам
предстоит создать сервис, добавить методы для отправки уведомлений и подключить его в TasksService.

Сервисы для работы с задачами (`TasksService`) и пользователями (`UsersService`) уже реализованы и предоставлены.

---

## Общая структура задачи

1. Отправка Email-уведомлений – уведомление пользователя при создании новой задачи.
2. Отправка SMS-уведомлений – уведомление пользователя при обновлении задачи.

---

### Email-уведомления при создании задачи

| Метод | Ссылка | Описание                                           | Параметры                                   |
| ----- | ------ | -------------------------------------------------- | ------------------------------------------- |
| POST  | /tasks | Создание новой задачи и отправка Email-уведомления | `title`, `description`, `assignedTo` (body) |

Пример запроса:

```http
POST http://localhost:3000/tasks
{
  "title": "Сделать домашнюю работу",
  "description": "Завершить домашнюю работу по программированию",
  "assignedTo": 1
}
```

Пример Email-уведомления:

- Кому: `user1@mail.com`
- Тема: `Новая задача`
- Текст: `Вы назначены ответственным за задачу: "Сделать домашнюю работу"`

Пример ответа сервера:

```json
{
  "id": "1",
  "title": "Сделать домашнюю работу",
  "description": "Завершить домашнюю работу по программированию",
  "assignedTo": 1,
  "status": "pending"
}
```

---

### SMS-уведомления при обновлении задачи

| Метод | Ссылка     | Описание                                     | Параметры                                            |
| ----- | ---------- | -------------------------------------------- | ---------------------------------------------------- |
| PATCH | /tasks/:id | Обновление задачи и отправка SMS-уведомления | `id` (path), `title`, `description`, `status` (body) |

Пример запроса:

```http
PATCH http://localhost:3000/tasks/1
{
  "status": "completed"
}
```

Пример SMS-уведомления:

- Кому: `+123456789`
- Текст: `Статус задачи "Сделать домашнюю работу" обновлён на "completed"`

Пример ответа сервера:

```json
{
  "id": "1",
  "title": "Сделать домашнюю работу",
  "description": "Завершить домашнюю работу по программированию",
  "assignedTo": 1,
  "status": "completed"
}
```

---

## Инструкции

1. Реализуйте сервис уведомлений:

   - Создайте `NotificationService` с двумя методами:
     - `sendEmail(to: string, subject: string, message: string): void` – отправка Email.
     - `sendSMS(to: string, message: string): void` – отправка SMS.
   - Для тестирования методы должны логировать уведомления в консоль:
     ```plaintext
     Email sent to user1@mail.com: [Новая задача] Вы назначены ответственным за задачу: "Сделать домашнюю работу"
     SMS sent to +123456789: Статус задачи "Сделать домашнюю работу" обновлён на "completed"
     ```

2. Подключите `NotificationService` в `TasksService`:

   - Вызовите `sendEmail` при создании задачи:
     - Используйте email пользователя из `UsersService` (получение пользователя по `assignedTo`).
   - Вызовите `sendSMS` при обновлении задачи:
     - Используйте номер телефона пользователя из `UsersService`.

3. Обработка ошибок:
   - Если пользователь с заданным `assignedTo` не найден, выбросите ошибку `404 Not Found`.
   - Если `sendEmail` или `sendSMS` вызываются с некорректными данными (например, пустым email или номером), выбросите ошибку `400 Bad Request`.

---

## Дополнительные (опциональные) задачи

1. Добавьте логирование:

   - Реализуйте логирование всех отправленных уведомлений (Email и SMS) в файл.

2. Параметризация NotificationService:
   - Добавьте возможность передавать конфигурацию (например, `senderEmail` или `smsGateway`) через параметры конструктора.

---

## Результат выполнения задачи

1. Реализованный `NotificationService` с методами `sendEmail` и `sendSMS`.
2. Корректно подключенный `NotificationService` в `TasksService`.
3. Отправка уведомлений пользователям при создании и обновлении задач.
4. Обработка ошибок для некорректных данных и отсутствующих пользователей.

---

Этот проект поможет вам освоить создание сервисов, внедрение зависимостей и работу с бизнес-логикой в приложении NestJS.
